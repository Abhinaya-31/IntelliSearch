{
  "name": "AuditLog",
  "type": "object",
  "properties": {
    "user_id": {
      "type": "string"
    },
    "action": {
      "type": "string",
      "enum": [
        "search",
        "document_view",
        "memory_save",
        "document_upload",
        "document_delete",
        "policy_change",
        "login",
        "logout",
        "export",
        "settings_change",
        "delete_action",
        "user_invite"
      ],
      "description": "Type of action"
    },
    "query": {
      "type": "string",
      "description": "Query if search"
    },
    "result_count": {
      "type": "number"
    },
    "collection_accessed": {
      "type": "string"
    },
    "details": {
      "type": "string",
      "description": "Action details"
    },
    "ip_address": {
      "type": "string"
    },
    "severity": {
      "type": "string",
      "enum": [
        "info",
        "warning",
        "critical"
      ],
      "default": "info"
    },
    "resource_type": {
      "type": "string",
      "description": "Type of resource affected"
    },
    "resource_id": {
      "type": "string",
      "description": "ID of affected resource"
    },
    "timestamp": {
      "type": "number"
    }
  },
  "required": [
    "action",
    "details"
  ]
}